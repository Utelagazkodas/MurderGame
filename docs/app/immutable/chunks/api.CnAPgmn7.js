import{I as U,K as A,R as E,n as M,ap as N,q as V,V as F}from"./utils.BHoosnMm.js";import{w as p}from"./index.8bhIGfqS.js";function G(e,t,...n){var l=e,o=M,a;U(()=>{o!==(o=t())&&(a&&(N(a),a=null),a=E(()=>o(l,...n)))},A),V&&(l=F)}let u="http://0.0.0.0:3000/";async function B(){let e=await fetch("./ip");return e.ok?(u=await e.text(),!0):!1}/*! typescript-cookie v1.0.6 | MIT */const $=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),C=e=>encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent),m=decodeURIComponent,h=e=>(e[0]==='"'&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent));function P(e){return e=Object.assign({},e),typeof e.expires=="number"&&(e.expires=new Date(Date.now()+e.expires*864e5)),e.expires!=null&&(e.expires=e.expires.toUTCString()),Object.entries(e).filter(([t,n])=>n!=null&&n!==!1).map(([t,n])=>n===!0?`; ${t}`:`; ${t}=${n.split(";")[0]}`).join("")}function S(e,t,n){const l=/(?:^|; )([^=]*)=([^;]*)/g,o={};let a;for(;(a=l.exec(document.cookie))!=null;)try{const i=n(a[1]);if(o[i]=t(a[2],i),e===i)break}catch{}return e!=null?o[e]:o}const k=Object.freeze({decodeName:m,decodeValue:h,encodeName:$,encodeValue:C}),y=Object.freeze({path:"/"});function b(e,t,n=y,{encodeValue:l=C,encodeName:o=$}={}){return document.cookie=`${o(e)}=${l(t,e)}${P(n)}`}function x(e,{decodeValue:t=h,decodeName:n=m}={}){return S(e,t,n)}function _({decodeValue:e=h,decodeName:t=m}={}){return S(void 0,e,t)}function w(e,t=y){b(e,"",Object.assign({},t,{expires:-1}))}function g(e,t){const n={set:function(o,a,i){return b(o,a,Object.assign({},this.attributes,i),{encodeValue:this.converter.write})},get:function(o){if(arguments.length===0)return _(this.converter.read);if(o!=null)return x(o,this.converter.read)},remove:function(o,a){w(o,Object.assign({},this.attributes,a))},withAttributes:function(o){return g(this.converter,Object.assign({},this.attributes,o))},withConverter:function(o){return g(Object.assign({},this.converter,o),this.attributes)}},l={attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(e)}};return Object.create(n,l)}g({read:k.decodeValue,write:k.encodeValue},y);function J(e){let t=e,n=t%60,l=n>0?`${n} másodperc`:"";t-=n;let o=Math.floor(t/60)%60,a=o>0?`${o} perc`:"";t-=o*60;let i=Math.floor(t/3600)%24,I=i>0?`${i} óra`:"";t-=i*3600;let f=Math.floor(t/(3600*24)),D=f>0?`${f} nap`:"",T=[D,I,a,l].filter(Boolean).join(" "),R=`${f}:${i}:${o}:${n}`;return{secs:n,mins:o,hours:i,days:f,secsString:l,minsString:a,hoursString:I,daysString:D,fullString:T,smallString:R}}function v(e){return e.meetingStart+e.meetingLength>L()}function L(){return Math.round(Date.now()/1e3)}function H(e,t){return e||t}let O=p(),r;O.subscribe(e=>{var t;r=e,e&&e.player&&console.log((t=e.player)==null?void 0:t.canCallMeeting)});let s="",d,Y=p(Math.floor(Date.now()/1e3)),j=p("");async function Q(){await B();let e=x("id");await c(),setInterval(()=>{Y.set(Math.floor(Date.now()/1e3))},1e3),e&&(await z(e,void 0)||(console.log(e),w("id"))),r?d=setInterval(c,5e3):d=setInterval(async()=>{await c(),r&&(clearInterval(d),d=setInterval(c,5e3))},1e3)}async function z(e,t){return t&&t.preventDefault(),r&&e!=""&&e.length==r.gamedata.idLength?(s=e,await c()?(b("id",e,{expires:365}),!0):(s="",!1)):(c(),!1)}async function c(e){e&&e.preventDefault;let t;return r&&s.length==r.gamedata.idLength?t=await fetch(`${u}players/${s}`):t=await fetch(u+"players"),t.ok&&(O.set(JSON.parse(await t.text())),r.player)?(j.set(r.player.voteID?r.player.voteID:""),!0):!1}async function W(e,t){if(t&&t.preventDefault(),!r||!r.player||!r.player.isKiller)return console.error("You cant kill someone because you are either not logged in or you are not the killer"),!1;v(r.gamedata)&&console.error("You cant kill during a meeting");const n=await fetch(`${u}kill/${e.publicID}`,{method:"POST",body:s});return console.log(await n.text()),n.ok?(console.log("sucesfully killed someone"),!0):(console.error("failed to kill someone"),!1)}async function X(e){s="",w("id"),c(),console.log("You logged out")}async function Z(e,t){if(t&&t.preventDefault(),r&&r.player&&r.player.revealDeath==null&&v(r.gamedata)){const n=await fetch(`${u}vote/${e.publicID}`,{method:"POST",body:s});return console.log(await n.text()),n.ok?(console.log("sucesfully voted for someone"),j.set(e.publicID),!0):(console.log("failed to vote for someone"),!1)}return console.error("You cant vote because you are not logged in or dead"),!1}async function ee(e){if(e&&e.preventDefault(),r&&r.player&&r.player.revealDeath==null&&r.player.canCallMeeting>0&&!v(r.gamedata)){const t=await fetch(`${u}meeting`,{method:"POST",body:s});return console.log(await t.text()),t.ok?(console.log("sucesfully voted for someone"),!0):(console.log("failed to vote for someone"),!1)}return console.error("You cant call meeting because you are not logged in or dead or it is already a meeting"),!1}export{J as a,j as b,z as c,ee as d,Q as e,H as f,O as g,v as i,W as k,X as l,G as s,Y as u,Z as v};

import{I as V,K as F,R as M,n as B,ap as P,q as _,V as L}from"./CJR8sh4W.js";import{w as m}from"./BM41IADg.js";function W(e,t,...n){var i=e,o=B,a;V(()=>{o!==(o=t())&&(a&&(P(a),a=null),a=M(()=>o(i,...n)))},F),_&&(i=L)}let d="http://0.0.0.0:3000/";async function Y(){let e=await fetch("./ip");return e.ok?(d=await e.text(),!0):!1}/*! typescript-cookie v1.0.6 | MIT */const k=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),C=e=>encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent),h=decodeURIComponent,y=e=>(e[0]==='"'&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent));function z(e){return e=Object.assign({},e),typeof e.expires=="number"&&(e.expires=new Date(Date.now()+e.expires*864e5)),e.expires!=null&&(e.expires=e.expires.toUTCString()),Object.entries(e).filter(([t,n])=>n!=null&&n!==!1).map(([t,n])=>n===!0?`; ${t}`:`; ${t}=${n.split(";")[0]}`).join("")}function x(e,t,n){const i=/(?:^|; )([^=]*)=([^;]*)/g,o={};let a;for(;(a=i.exec(document.cookie))!=null;)try{const l=n(a[1]);if(o[l]=t(a[2],l),e===l)break}catch{}return e!=null?o[e]:o}const S=Object.freeze({decodeName:h,decodeValue:y,encodeName:k,encodeValue:C}),b=Object.freeze({path:"/"});function v(e,t,n=b,{encodeValue:i=C,encodeName:o=k}={}){return document.cookie=`${o(e)}=${i(t,e)}${z(n)}`}function O(e,{decodeValue:t=y,decodeName:n=h}={}){return x(e,t,n)}function K({decodeValue:e=y,decodeName:t=h}={}){return x(void 0,e,t)}function $(e,t=b){v(e,"",Object.assign({},t,{expires:-1}))}function p(e,t){const n={set:function(o,a,l){return v(o,a,Object.assign({},this.attributes,l),{encodeValue:this.converter.write})},get:function(o){if(arguments.length===0)return K(this.converter.read);if(o!=null)return O(o,this.converter.read)},remove:function(o,a){$(o,Object.assign({},this.attributes,a))},withAttributes:function(o){return p(this.converter,Object.assign({},this.attributes,o))},withConverter:function(o){return p(Object.assign({},this.converter,o),this.attributes)}},i={attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(e)}};return Object.create(n,i)}p({read:S.decodeValue,write:S.encodeValue},b);function X(e){let t=e,n=t%60,i=n>0?`${n} másodperc`:"";t-=n;let o=Math.floor(t/60)%60,a=o>0?`${o} perc`:"";t-=o*60;let l=Math.floor(t/3600)%24,I=l>0?`${l} óra`:"";t-=l*3600;let u=Math.floor(t/(3600*24)),D=u>0?`${u} nap`:"",R=[D,I,a,i].filter(Boolean).join(" "),U=`${u} n ${l} ó ${o} p ${n} m`;const f=N=>String(N).padStart(2,"0");let A=`${u} nap ${f(l)}:${f(o)}:${f(n)}`,E=`${f(l+u*24)}:${f(o)}:${f(n)}`;return{secs:n,mins:o,hours:l,days:u,secsString:i,minsString:a,hoursString:I,daysString:D,fullString:R,smallString:A,altFullString:U,altSmallString:E}}function w(e){return e.meetingStart+e.meetingLength>q()}function q(){return Math.round(Date.now()/1e3)}function Z(e,t){return e||t}let j=m(),r;j.subscribe(e=>{r=e});let s="",g,G=m(Math.floor(Date.now()/1e3)),T=m("");async function ee(){await Y();let e=O("id");await c(),e&&(await J(e,void 0)||(console.log(e),$("id"))),setInterval(()=>{G.set(Math.floor(Date.now()/1e3))},1e3),r?g=setInterval(c,5e3):g=setInterval(async()=>{await c(),r&&(clearInterval(g),g=setInterval(c,5e3))},1e3)}async function J(e,t){return t&&t.preventDefault(),r&&e!=""&&e.length==r.gamedata.idLength?(s=e,await c()?(v("id",e,{expires:365}),!0):(s="",!1)):(c(),!1)}async function c(e){e&&e.preventDefault;let t;return r&&s.length==r.gamedata.idLength?t=await fetch(`${d}players/${s}`):t=await fetch(d+"players"),t.ok&&(j.set(JSON.parse(await t.text())),r.player)?(T.set(r.player.voteID?r.player.voteID:""),!0):!1}async function te(e,t){if(t&&t.preventDefault(),!r||!r.player||!r.player.isKiller)return console.error("You cant kill someone because you are either not logged in or you are not the killer"),!1;w(r.gamedata)&&console.error("You cant kill during a meeting");const n=await fetch(`${d}kill/${e.publicID}`,{method:"POST",body:s});return console.log(await n.text()),n.ok?(console.log("sucesfully killed someone"),!0):(console.error("failed to kill someone"),!1)}async function ne(e){s="",$("id"),c(),console.log("You logged out")}async function oe(e,t){if(t&&t.preventDefault(),r&&r.player&&r.player.revealDeath==null&&w(r.gamedata)){const n=await fetch(`${d}vote/${e.publicID}`,{method:"POST",body:s});return console.log(await n.text()),n.ok?(console.log("sucesfully voted for someone"),T.set(e.publicID),!0):(console.log("failed to vote for someone"),!1)}return console.error("You cant vote because you are not logged in or dead"),!1}async function re(e){if(e&&e.preventDefault(),r&&r.player&&r.player.revealDeath==null&&r.player.canCallMeeting>0&&!w(r.gamedata)){const t=await fetch(`${d}meeting`,{method:"POST",body:s});return console.log(await t.text()),t.ok?(console.log("sucesfully voted for someone"),!0):(console.log("failed to vote for someone"),!1)}return console.error("You cant call meeting because you are not logged in or dead or it is already a meeting"),!1}export{X as a,T as b,J as c,re as d,ee as e,Z as f,j as g,w as i,te as k,ne as l,W as s,G as u,oe as v};

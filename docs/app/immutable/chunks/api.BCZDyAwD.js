import{w as x}from"./index.B0ZoSdI1.js";let u="http://0.0.0.0:3000/";async function k(){let e=await fetch("./ip");return e.ok?(u=await e.text(),!0):!1}/*! typescript-cookie v1.0.6 | MIT */const w=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),b=e=>encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent),d=decodeURIComponent,p=e=>(e[0]==='"'&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent));function I(e){return e=Object.assign({},e),typeof e.expires=="number"&&(e.expires=new Date(Date.now()+e.expires*864e5)),e.expires!=null&&(e.expires=e.expires.toUTCString()),Object.entries(e).filter(([t,n])=>n!=null&&n!==!1).map(([t,n])=>n===!0?`; ${t}`:`; ${t}=${n.split(";")[0]}`).join("")}function C(e,t,n){const s=/(?:^|; )([^=]*)=([^;]*)/g,r={};let o;for(;(o=s.exec(document.cookie))!=null;)try{const i=n(o[1]);if(r[i]=t(o[2],i),e===i)break}catch{}return e!=null?r[e]:r}const m=Object.freeze({decodeName:d,decodeValue:p,encodeName:w,encodeValue:b}),g=Object.freeze({path:"/"});function h(e,t,n=g,{encodeValue:s=b,encodeName:r=w}={}){return document.cookie=`${r(e)}=${s(t,e)}${I(n)}`}function O(e,{decodeValue:t=p,decodeName:n=d}={}){return C(e,t,n)}function D({decodeValue:e=p,decodeName:t=d}={}){return C(void 0,e,t)}function j(e,t=g){h(e,"",Object.assign({},t,{expires:-1}))}function f(e,t){const n={set:function(r,o,i){return h(r,o,Object.assign({},this.attributes,i),{encodeValue:this.converter.write})},get:function(r){if(arguments.length===0)return D(this.converter.read);if(r!=null)return O(r,this.converter.read)},remove:function(r,o){j(r,Object.assign({},this.attributes,o))},withAttributes:function(r){return f(this.converter,Object.assign({},this.attributes,r))},withConverter:function(r){return f(Object.assign({},this.converter,r),this.attributes)}},s={attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(e)}};return Object.create(n,s)}f({read:m.decodeValue,write:m.encodeValue},g);let y=x(),c;y.subscribe(e=>{c=e});let a="";async function V(){await k();let e=O("id");await l(),e&&(await $(e,void 0)||(console.log(e),j("id")))}async function $(e,t){return t&&t.preventDefault(),c&&e!=""&&e.length==c.gamedata.idLength?(a=e,await l()?(h("id",e,{expires:365}),!0):(a="",!1)):(l(),!1)}async function l(e){let t;return c&&a.length==c.gamedata.idLength?t=await fetch(`${u}players/${a}`):t=await fetch(u+"players"),!!(t.ok&&(y.set(JSON.parse(await t.text())),c.player))}async function v(e,t){t&&t.preventDefault();const n=await fetch(`${u}players/${e.publicID}`,{method:"POST",body:a});return console.log(await n.text()),!!n.ok}async function A(e){a="",l()}export{y as g,V as i,v as k,A as l,$ as s};

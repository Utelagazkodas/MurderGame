import{I as N,K as V,R as F,n as B,ap as L,q as P,V as _}from"./CJR8sh4W.js";import{w as m}from"./BM41IADg.js";function Q(e,t,...o){var i=e,n=B,a;N(()=>{n!==(n=t())&&(a&&(L(a),a=null),a=F(()=>n(i,...o)))},V),P&&(i=_)}let d="http://0.0.0.0:3000/";async function Y(){let e=await fetch("./ip");return e.ok?(d=await e.text(),!0):!1}/*! typescript-cookie v1.0.6 | MIT */const k=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),C=e=>encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent),h=decodeURIComponent,y=e=>(e[0]==='"'&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent));function z(e){return e=Object.assign({},e),typeof e.expires=="number"&&(e.expires=new Date(Date.now()+e.expires*864e5)),e.expires!=null&&(e.expires=e.expires.toUTCString()),Object.entries(e).filter(([t,o])=>o!=null&&o!==!1).map(([t,o])=>o===!0?`; ${t}`:`; ${t}=${o.split(";")[0]}`).join("")}function x(e,t,o){const i=/(?:^|; )([^=]*)=([^;]*)/g,n={};let a;for(;(a=i.exec(document.cookie))!=null;)try{const l=o(a[1]);if(n[l]=t(a[2],l),e===l)break}catch{}return e!=null?n[e]:n}const S=Object.freeze({decodeName:h,decodeValue:y,encodeName:k,encodeValue:C}),v=Object.freeze({path:"/"});function b(e,t,o=v,{encodeValue:i=C,encodeName:n=k}={}){return document.cookie=`${n(e)}=${i(t,e)}${z(o)}`}function O(e,{decodeValue:t=y,decodeName:o=h}={}){return x(e,t,o)}function W({decodeValue:e=y,decodeName:t=h}={}){return x(void 0,e,t)}function w(e,t=v){b(e,"",Object.assign({},t,{expires:-1}))}function p(e,t){const o={set:function(n,a,l){return b(n,a,Object.assign({},this.attributes,l),{encodeValue:this.converter.write})},get:function(n){if(arguments.length===0)return W(this.converter.read);if(n!=null)return O(n,this.converter.read)},remove:function(n,a){w(n,Object.assign({},this.attributes,a))},withAttributes:function(n){return p(this.converter,Object.assign({},this.attributes,n))},withConverter:function(n){return p(Object.assign({},this.converter,n),this.attributes)}},i={attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(e)}};return Object.create(o,i)}p({read:S.decodeValue,write:S.encodeValue},v);function X(e){let t=e;e<0&&(t=0);let o=t%60,i=o>0?`${o} másodperc`:"";t-=o;let n=Math.floor(t/60)%60,a=n>0?`${n} perc`:"";t-=n*60;let l=Math.floor(t/3600)%24,D=l>0?`${l} óra`:"";t-=l*3600;let u=Math.floor(t/(3600*24)),I=u>0?`${u} nap`:"",R=[I,D,a,i].filter(Boolean).join(" "),U=`${u} n ${l} ó ${n} p ${o} m`;const f=M=>String(M).padStart(2,"0");let A=`${u} nap ${f(l)}:${f(n)}:${f(o)}`,E=`${f(l+u*24)}:${f(n)}:${f(o)}`;return{secs:o,mins:n,hours:l,days:u,secsString:i,minsString:a,hoursString:D,daysString:I,fullString:R,smallString:A,altFullString:U,altSmallString:E}}function $(e){return e.meetingStart+e.meetingLength>K()}function K(){return Math.round(Date.now()/1e3)}function Z(e,t){return e||t}let j=m(),r;j.subscribe(e=>{r=e});let c="",g,q=m(Math.floor(Date.now()/1e3)),T=m("");async function ee(){await Y();let e=O("id");await s(),e&&(await G(e,void 0)||(console.log(e),w("id"))),setInterval(()=>{q.set(Math.floor(Date.now()/1e3)),Math.floor(Date.now()/1e3)>=r.gamedata.meetingStart+r.gamedata.meetingLength&&s()},1e3),r?g=setInterval(s,5e3):g=setInterval(async()=>{await s(),r&&(clearInterval(g),g=setInterval(s,5e3))},1e3)}async function G(e,t){return t&&t.preventDefault(),r&&e!=""&&e.length==r.gamedata.idLength?(c=e,await s()?(b("id",e,{expires:365}),!0):(c="",!1)):(s(),!1)}async function s(e){e&&e.preventDefault;let t;return r&&c.length==r.gamedata.idLength?t=await fetch(`${d}players/${c}`):t=await fetch(d+"players"),t.ok&&(j.set(JSON.parse(await t.text())),r.player)?(T.set(r.player.voteID?r.player.voteID:""),!0):!1}async function te(e,t){if(t&&t.preventDefault(),r.gamedata.gameWon!=0)return console.error("you cant kill someone, the game is over"),!1;if(!r||!r.player||!r.player.isKiller)return console.error("You cant kill someone because you are either not logged in or you are not the killer"),!1;$(r.gamedata)&&console.error("You cant kill during a meeting");const o=await fetch(`${d}kill/${e.publicID}`,{method:"POST",body:c});return s(),console.log(await o.text()),o.ok?(console.log("sucesfully killed someone"),!0):(console.error("failed to kill someone"),!1)}async function oe(e){c="",w("id"),s(),console.log("You logged out")}async function ne(e,t){if(r.gamedata.gameWon!=0)return console.error("you cant vote, the game is over"),!1;if(t&&t.preventDefault(),r&&r.player&&r.player.revealDeath==null&&$(r.gamedata)){const o=await fetch(`${d}vote/${e.publicID}`,{method:"POST",body:c});return s(),console.log(await o.text()),o.ok?(console.log("sucesfully voted for someone"),T.set(e.publicID),!0):(console.log("failed to vote for someone"),!1)}return console.error("You cant vote because you are not logged in or dead"),!1}async function re(e){if(r.gamedata.gameWon!=0)return console.error("you cant call meeting, the game is over"),!1;if(e&&e.preventDefault(),r&&r.player&&r.player.revealDeath==null&&r.player.canCallMeeting>0&&!$(r.gamedata)){const t=await fetch(`${d}meeting`,{method:"POST",body:c});return s(),console.log(await t.text()),t.ok?(console.log("sucesfully voted for someone"),!0):(console.log("failed to vote for someone"),!1)}return console.error("You cant call meeting because you are not logged in or dead or it is already a meeting"),!1}export{X as a,T as b,G as c,re as d,ee as e,Z as f,j as g,$ as i,te as k,oe as l,Q as s,q as u,ne as v};
